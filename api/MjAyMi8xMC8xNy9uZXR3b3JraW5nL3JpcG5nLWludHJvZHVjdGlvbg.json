{"title":"RIPng Introduction","date":"2022-10-16T16:00:00.000Z","date_formatted":{"ll":"Oct 17, 2022","L":"10/17/2022","MM-DD":"10-17"},"link":"2022/10/17/networking/ripng-introduction","tags":["L3","networking","routing","routing protocol"],"categories":["networking"],"updated":"2022-10-24T16:00:00.000Z","content":"<p>Routing Information Protocol Next Generation for IPv6</p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th style=\"text-align:center\">Version 1</th>\n<th style=\"text-align:center\">Version 2</th>\n<th style=\"text-align:center\">Next Generation</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\"><a href=\"https://www.rfc-editor.org/rfc/rfc1058\" target=\"_blank\">RFC 1058</a></td>\n<td style=\"text-align:center\"><a href=\"https://www.rfc-editor.org/rfc/rfc2453\" target=\"_blank\">RFC 4822</a></td>\n<td style=\"text-align:center\"><a href=\"https://www.rfc-editor.org/rfc/rfc2080\" target=\"_blank\">RFC 2080</a></td>\n</tr>\n</tbody>\n</table></div></div><span id=\"more\"></span>\n<h2 id=\"ripng\">RIPng<a title=\"#ripng\" href=\"#ripng\"></a></h2>\n<ul>\n<li>Supports <strong>multiple</strong> IPv6 addresses on <em>each</em> interface</li>\n<li>Protocol &amp; Port: UDP, <strong><code>521</code></strong></li>\n</ul>\n<h3 id=\"packet-frame\">Packet Frame<a title=\"#packet-frame\" href=\"#packet-frame\"></a></h3>\n<p><img src=\"https://download.huawei.com/mdl/image/download?uuid=f8ac22dfd01c4c23aea1be32dadfdf04\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p style=\"font-size:10px;text-align:center\">Source: <a href=\"https://support.huawei.com/enterprise/en/doc/EDOC1100058403/b0f8860e/ripng-packet-format\">https://support.huawei.com/enterprise/en/doc/EDOC1100058403/b0f8860e/ripng-packet-format</a></p>\n<p>the <code>version</code> field: set to 1</p>\n<p>the <code>command</code> field:<br>\n<strong>1-Request</strong>: A request to send all or part of of routing table. ( specific / whole-table )<br>\n<strong>2-Response</strong>: A response containing all or part of routing table, this can be sent in response to a request or sent in unsolicited.</p>\n<p>The maximum RTE(s) capbility of a packet: <span style=\"font-size:12px;\">(depends on <strong>MTU</strong> size of the interface</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">               +   MTU - sizeof(IPv6_Headers) - UDP_Header_Len - RIPng_Header_Len   +</span><br><span class=\"line\">#RTE(s) =  INT | -----------------------------------------------------------------  |</span><br><span class=\"line\">               +                           RTE_size                                 +</span><br></pre></td></tr></table></figure>\n<p style=\"font-size:10px;text-align:center\">Source: <a href=\"https://sites.google.com/site/amitsciscozone/ipv6/ripng\">https://sites.google.com/site/amitsciscozone/ipv6/ripng</a></p>\n<h4 id=\"route-table-entry-packet-detail\">Route Table Entry Packet Detail<a title=\"#route-table-entry-packet-detail\" href=\"#route-table-entry-packet-detail\"></a></h4>\n<h5 id=\"1.-next-hop-rte\">1. Next Hop RTE<a title=\"#1.-next-hop-rte\" href=\"#1.-next-hop-rte\"></a></h5>\n<p>It defines the IPv6 address of the next hop and is located <strong>before</strong> a group of IPv6-prefix RTEs that have the same next hop. The Metric field of a next hop RTE is always <code>0xFF</code>.</p>\n<!-- ![](https://download.huawei.com/mdl/image/download?uuid=37df5f813d574fd799446e02c9e748b2) -->\n<img class=\"φbp\" src=\"https://download.huawei.com/mdl/image/download?uuid=37df5f813d574fd799446e02c9e748b2\" alt=\"\" loading=\"lazy\">\n<p style=\"font-size:10px;text-align:center\">Source: <a href=\"https://support.huawei.com/enterprise/en/doc/EDOC1100058403/b0f8860e/ripng-packet-format\">https://support.huawei.com/enterprise/en/doc/EDOC1100058403/b0f8860e/ripng-packet-format</a></p>\n<p><img src=\"https://raw.githubusercontent.com/jason19970210/MarkdownPhotos/master/Screenshot%20from%202022-10-19%2016-11-37.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<h5 id=\"2.-ipv6-prefix-rte\">2. IPv6 Prefix RTE<a title=\"#2.-ipv6-prefix-rte\" href=\"#2.-ipv6-prefix-rte\"></a></h5>\n<p>It describes the destination IPv6 address and the cost in the RIPng routing table and is located <strong>after</strong> a next hop RTE. A next hop RTE can be followed by multiple different IPv6-prefix RTEs</p>\n<!-- ![](https://download.huawei.com/mdl/image/download?uuid=911789767efb4bdd991960e3bc3f7185) -->\n<img class=\"φbp\" src=\"https://download.huawei.com/mdl/image/download?uuid=911789767efb4bdd991960e3bc3f7185\" alt=\"\" loading=\"lazy\">\n<p style=\"font-size:10px;text-align:center\">Source: <a href=\"https://support.huawei.com/enterprise/en/doc/EDOC1100058403/b0f8860e/ripng-packet-format\">https://support.huawei.com/enterprise/en/doc/EDOC1100058403/b0f8860e/ripng-packet-format</a></p>\n<p><img src=\"https://raw.githubusercontent.com/jason19970210/MarkdownPhotos/master/Screenshot%20from%202022-10-19%2016-14-51.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<h3 id=\"timer-/-intervals\"><a href=\"https://www.rfc-editor.org/rfc/rfc2080.html#section-2.3\">Timer / Intervals</a><a title=\"#timer-/-intervals\" href=\"#timer-/-intervals\"></a></h3>\n<p>All mentioned as default:</p>\n<ul>\n<li>Update Timer: 30 secs</li>\n<li>(Route) Timeout  / Age Timer: 180 secs</li>\n<li>Garbage Collection Timeout Timer: 120 secs</li>\n<li>Hold-Down Timer: (NOT described in RFC 2080)\n<ul>\n<li>mentioned in <a href=\"https://support.huawei.com/enterprise/en/doc/EDOC1100058403/c193f046/timers\" target=\"_blank\">https://support.huawei.com/enterprise/en/doc/EDOC1100058403/c193f046/timers</a>\n<ul>\n<li>disable by default, if configured, hold-down timer starts after receives a route with cost greater than 16.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Update Timer has a <strong>random offset</strong> within <code>+/- 0 to 15 seconds</code>,<br>\nthe offset is derived from <code>0.5 * Update Timer</code></p>\n<p>ref: <a href=\"https://docs.ruckuswireless.com/fastiron/08.0.40/fastiron-08040a-l3guide/GUID-97023AC1-C034-40EA-B02D-1E3E9DACCAC7.html\" target=\"_blank\">https://docs.ruckuswireless.com/fastiron/08.0.40/fastiron-08040a-l3guide/GUID-97023AC1-C034-40EA-B02D-1E3E9DACCAC7.html</a><br>\nref: <a href=\"https://techhub.hpe.com/eginfolib/networking/docs/switches/5130ei/5200-3943_l3-ip-rtng_cg/content/483570120.htm\" target=\"_blank\">https://techhub.hpe.com/eginfolib/networking/docs/switches/5130ei/5200-3943_l3-ip-rtng_cg/content/483570120.htm</a><br>\nref: <a href=\"https://www.arubanetworks.com/techdocs/AOS-CX/AOSCX-CLI-Bank/cli_8400/Content/Chp_RIP/RIPng_cmds/tim-upd-rip-ipv-10.htm\" target=\"_blank\">https://www.arubanetworks.com/techdocs/AOS-CX/AOSCX-CLI-Bank/cli_8400/Content/Chp_RIP/RIPng_cmds/tim-upd-rip-ipv-10.htm</a></p>\n<h3 id=\"input-processing\"><a href=\"https://www.rfc-editor.org/rfc/rfc2080.html#section-2.4\">Input Processing</a><a title=\"#input-processing\" href=\"#input-processing\"></a></h3>\n<h4 id=\"request-messages\"><a href=\"https://www.rfc-editor.org/rfc/rfc2080.html#section-2.4.1\">Request Messages</a><a title=\"#request-messages\" href=\"#request-messages\"></a></h4>\n<ul>\n<li>normally sent as <code>multicasts</code>, can be unicast direct</li>\n<li>no entry, then no response is given</li>\n<li>a whole-table request comes with <code>only/exactly</code> 1 entry as destination prefix of 0, a prefix length of 0, and a metric of infinity (16)\n<ul>\n<li>the response will include the <code>Split Horizon</code></li>\n</ul>\n</li>\n<li>a request for specific entries no <code>Split Horizon</code> processing is done, due to these requests might be used for different purpose</li>\n</ul>\n<h4 id=\"response-messages\"><a href=\"https://www.rfc-editor.org/rfc/rfc2080.html#section-2.4.2\">Response Messages</a><a title=\"#response-messages\" href=\"#response-messages\"></a></h4>\n<ul>\n<li>must be ignored if it is not from the RIPng port</li>\n<li>shold check the datagram is from a valid neighbor</li>\n<li>the source of the datagram must be <code>local-link</code> address <a href=\"https://zh.wikipedia.org/zh-tw/%E9%93%BE%E8%B7%AF%E6%9C%AC%E5%9C%B0%E5%9C%B0%E5%9D%80\" target=\"_blank\">(wiki)</a>,\n<ul>\n<li>and not one of the router’s own addresses</li>\n</ul>\n</li>\n<li>(?) periodic advertisements must have their hop counts set to 255, and inbound, multicast packets sent from the RIPng port (i.e. periodic advertisement or triggered update packets) must be examined to ensure that the hop count is 255\n<ul>\n<li>This absolutely guarantees that a packet is from a neighbor, because any intermediate node would have decremented the hop count</li>\n<li>(-) not yet confirm, but there is no data in the RIPng sample from wireshark</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"rte-validation\">RTE Validation<a title=\"#rte-validation\" href=\"#rte-validation\"></a></h5>\n<ul>\n<li>destination prefix validation\n<ul>\n<li>not a multicast prefix and not a local-link prefix, a link-local address should <strong>never</strong> be present in a RTE</li>\n</ul>\n</li>\n<li>prefix length validation (i.e., between 0 and 128, inclusive)</li>\n<li>metric validation (i.e., between 1 and 16, inclusive)</li>\n</ul>\n<blockquote>\n<p>If the existing route is showing signs of timing out, it may be better to switch to an equally-good alternative route immediately, rather than waiting for the timeout to happen.<br>\nTherefore, if the new metric is the same as the old one, examine the timeout for the existing route.<br>\nIf it is at least halfway to the expiration point, switch to the new route.<br>\nThis heuristic is optional, but highly recommended.</p>\n</blockquote>\n<h3 id=\"output-processing\"><a href=\"https://www.rfc-editor.org/rfc/rfc2080.html#section-2.5\">Output Processing</a><a title=\"#output-processing\" href=\"#output-processing\"></a></h3>\n<p>Process be triggered:</p>\n<ul>\n<li>when a input request is received, the output response is only sent to the requestor via unicast</li>\n<li>by regular routing update, with the whole routing table</li>\n<li>by triggered updates, whenever the metric for a router is changed</li>\n</ul>\n<p>Multicast to all neighbors comes with the multicast group <code>FF02::9</code></p>\n<h4 id=\"triggered-updates\">Triggered Updates<a title=\"#triggered-updates\" href=\"#triggered-updates\"></a></h4>\n<ul>\n<li><strong>After</strong> a triggered update is sent, a timer should be set for a <strong>random interval</strong> between 1 and 5 seconds</li>\n<li>triggered updates should <strong>only</strong> includes those routers which have changed</li>\n<li>If input processing is allowed while output is being generated, appropriate interlocking must be done.  The route change flags <strong>should not</strong> be changed as a result of processing input while a triggered update message is being generated.</li>\n</ul>\n<h4 id=\"generating-response-messages\">Generating Response Messages<a title=\"#generating-response-messages\" href=\"#generating-response-messages\"></a></h4>\n<ul>\n<li>IPv6 source address must be <code>link-local</code> address, except when replying a unicast Request Message from a port other than the RIPng port\n<blockquote>\n<p>the source address is put into routing tables (as the next hop) in the routers which receive this Response</p>\n</blockquote>\n</li>\n<li>the router must only originate a single Response message with a source address of the designated link-local address for a given interface</li>\n<li>The choice of which link-local address to use should only change when the current choice is no longer valid.  This is necessary because nodes receiving Response messages use the source address to identify the sender\n<blockquote>\n<p>If multiple packets from the same router contain different source addresses, nodes will assume they come from different routers, leading to undesirable behavior.</p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"split-horizon\"><a href=\"https://www.rfc-editor.org/rfc/rfc2080.html#section-2.6\">Split Horizon</a><a title=\"#split-horizon\" href=\"#split-horizon\"></a></h3>\n<p>wiki: <a href=\"https://en.wikipedia.org/wiki/Split_horizon_route_advertisement\" target=\"_blank\">https://en.wikipedia.org/wiki/Split_horizon_route_advertisement</a></p>\n<p>Split Horizon is a algorithm for avoiding problems caused by including routes in updates sent to the gateway from which they were learned</p>\n<h4 id=\"basic\">Basic<a title=\"#basic\" href=\"#basic\"></a></h4>\n<ul>\n<li>The basic split horizon algorithm <strong>omits</strong> routes learned from one neighbor in updates sent to that neighbor.</li>\n</ul>\n<h4 id=\"poison-reverse\">Poison Reverse<a title=\"#poison-reverse\" href=\"#poison-reverse\"></a></h4>\n<p>Often used within <code>distance-vector</code> routing, it set the route information to <code>infinity</code> instead of perform the age timer timeout</p>\n<blockquote>\n<p>accelerate the route convergence(收斂)</p>\n</blockquote>\n<hr>\n<p>ref: <a href=\"https://en.wikipedia.org/wiki/Routing_Information_Protocol\" target=\"_blank\">https://en.wikipedia.org/wiki/Routing_Information_Protocol</a><br>\nref: <a href=\"https://www.rfc-editor.org/rfc/rfc2080.html\" target=\"_blank\">https://www.rfc-editor.org/rfc/rfc2080.html</a><br>\nref: <a href=\"https://blog.csdn.net/zjy123078_zjy/article/details/102584527\" target=\"_blank\">https://blog.csdn.net/zjy123078_zjy/article/details/102584527</a></p>\n","prev":{"title":"OSPF NSF Introduction","link":"2022/10/17/networking/ospf-nsf"},"next":{"title":"RIPv2 Introduction","link":"2022/10/01/networking/ripv2-introduction"},"plink":"https://jason19970210.github.io/2022/10/17/networking/ripng-introduction/","toc":[{"id":"ripng","title":"RIPng","index":"1","children":[{"id":"packet-frame","title":"Packet Frame","index":"1.1"},{"id":"timer-/-intervals","title":"Timer &#x2F; Intervals","index":"1.2"},{"id":"input-processing","title":"Input Processing","index":"1.3"},{"id":"output-processing","title":"Output Processing","index":"1.4"},{"id":"split-horizon","title":"Split Horizon","index":"1.5"}]}],"reading_time":"1093 words in 7 min"}
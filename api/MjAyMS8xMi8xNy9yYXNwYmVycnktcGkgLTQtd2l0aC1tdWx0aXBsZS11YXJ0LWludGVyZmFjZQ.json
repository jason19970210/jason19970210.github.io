{"title":"Raspberry Pi 4 with Multiple UART Interfaces","date":"2021-12-16T16:00:00.000Z","date_formatted":{"ll":"Dec 17, 2021","L":"12/17/2021","MM-DD":"12-17"},"thumbnail":"https://miro.medium.com/max/720/0*wKhpJO1bfvRlAd2Q","link":"2021/12/17/raspberry-pi -4-with-multiple-uart-interface","tags":["UART","linux","raspberry pi"],"categories":["linux"],"updated":"2022-10-16T16:00:00.000Z","content":"<p>Sometimes we need the lots of components, sensors, modules using the <code>UART</code> interfaces to communicate with the Raspberry Pi.</p>\n<span id=\"more\"></span>\n<p>Post in Medium: <a href=\"https://medium.com/@jason19970210/raspberry-pi-4-with-multiple-uart-interface-4eac75f74d7c\" target=\"_blank\">https://medium.com/@jason19970210/raspberry-pi-4-with-multiple-uart-interface-4eac75f74d7c</a></p>\n<h3 id=\"environment\">Environment<a title=\"#environment\" href=\"#environment\"></a></h3>\n<ol>\n<li>Hardware : Raspberry Pi 4 Model B (BCM2177*) <a href=\"https://www.raspberrypi.com/documentation/computers/processors.html#bcm2711\" target=\"_blank\">ref</a></li>\n<li>Operation System : Respbian Linux 11</li>\n<li>CPU Arch: armv7l</li>\n</ol>\n<p>There are 2 types of UART interface existed on Raspberry Pi, <code>mini UART</code> &amp; <code>PL011 UART</code>.<br>\nBy default, <code>/dev/ttyS0</code> maps to <code>mini UART</code>; on the other hand, <code>/dev/ttyAMA0</code> maps to <code>PL011 UART</code>.</p>\n<h3 id=\"software-setup\">Software Setup<a title=\"#software-setup\" href=\"#software-setup\"></a></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo su</span><br><span class=\"line\">$ vim /boot/config.txt</span><br></pre></td></tr></table></figure>\n<p>add following lines at the end of the file:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># enable serial interface</span><br><span class=\"line\">enable_uart=1</span><br><span class=\"line\">dtoverlay=uart0</span><br><span class=\"line\">dtoverlay=uart1</span><br><span class=\"line\">dtoverlay=uart2</span><br><span class=\"line\">dtoverlay=uart3</span><br><span class=\"line\">dtoverlay=uart4</span><br><span class=\"line\">dtoverlay=uart5</span><br></pre></td></tr></table></figure>\n<p>Save, exit &amp; Reboot !!</p>\n<p>Check system open the serial by command $ ls -al /dev/ttyAMA*</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ls -al /dev/ttyAMA*</span><br><span class=\"line\">crw-rw---- 1 root dialout 204, 64 Dec 16 16:01 /dev/ttyAMA0</span><br><span class=\"line\">crw-rw---- 1 root dialout 204, 65 Dec 16 16:01 /dev/ttyAMA1</span><br><span class=\"line\">crw-rw---- 1 root dialout 204, 66 Dec 16 16:01 /dev/ttyAMA2</span><br><span class=\"line\">crw-rw---- 1 root dialout 204, 67 Dec 16 16:01 /dev/ttyAMA3</span><br><span class=\"line\">crw-rw---- 1 root dialout 204, 68 Dec 16 16:01 /dev/ttyAMA4</span><br></pre></td></tr></table></figure>\n<p>Let’s take a look into the Raspberry Pi 4 Model B GPIO Pinout:<br>\n<img src=\"https://www.raspberrypi.com/documentation/computers/images/GPIO-Pinout-Diagram-2.png\" alt=\"\" loading=\"lazy\"><br>\nGPIO Pinout : <a href=\"https://www.raspberrypi.com/documentation/computers/os.html#gpio-and-the-40-pin-header\" target=\"_blank\">https://www.raspberrypi.com/documentation/computers/os.html#gpio-and-the-40-pin-header</a></p>\n<h3 id=\"hardware-setup\">Hardware Setup<a title=\"#hardware-setup\" href=\"#hardware-setup\"></a></h3>\n<p>Raspberry Pi Pin pair with UART:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">           TXD       RXD         Communication Port</span><br><span class=\"line\">uart0 :  GPIO 14    GPIO 15         /dev/ttyAMA0 </span><br><span class=\"line\">uart1 :  GPIO 0     GPIO 1          /dev/ttyAMA1</span><br><span class=\"line\">uart2 :  GPIO 4     GPIO 5          /dev/ttyAMA2</span><br><span class=\"line\">uart3 :  GPIO 8     GPIO 9          /dev/ttyAMA3</span><br><span class=\"line\">uart4 :  GPIO 12    GPIO 13         /dev/ttyAMA4</span><br></pre></td></tr></table></figure>\n<p>PC setup with USB-to-UART Adapter :<br>\n<img src=\"https://miro.medium.com/max/720/0*0vp6AQFb3SL7of8I.jpg\" alt=\"\" loading=\"lazy\"><br>\nFT232 : <a href=\"https://www.waveshare.com/ft232-usb-uart-board-type-a.htm\" target=\"_blank\">https://www.waveshare.com/ft232-usb-uart-board-type-a.htm</a></p>\n<p>Please make sure <code>GND</code> is connected correctly !<br>\nUSB-to-UART <code>TXD</code> connect to Raspberry Pi uart <code>RXD</code> GPIO Pin<br>\nUSB-to-UART <code>RXD</code> connect to Raspberry Pi uart <code>TXD</code> GPIO Pin</p>\n<p>Take uart3 for example:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">USB-to-UART TXD &lt;--&gt; GPIO 8</span><br><span class=\"line\">USB-to-UART RXD &lt;--&gt; GPIO 9</span><br><span class=\"line\">USB-to-UART GND &lt;--&gt; GND</span><br></pre></td></tr></table></figure>\n<h3 id=\"implementation\">Implementation<a title=\"#implementation\" href=\"#implementation\"></a></h3>\n<p>Once finish setup, open a serial console on PC (ex. Putty) with correct COM Port (ex. COM3) &amp; Baud Rate set to 115200</p>\n<p>Then open a terminal in Raspberry Pi, send message from CLI to PC :<br>\n<code>$ echo 'hello' &gt; /dev/ttyAMA3</code></p>\n<p>This command should send the string hello to PC via /dev/ttyAMA3 , then the string will be parsed by PC, finally display on serial console.<br>\nHope this article can help those makers connect more devices via multiple UART interfaces !!</p>\n<p>Cover photo by <a href=\"https://unsplash.com/@davealmine\" target=\"_blank\">Dawid Zawiła</a> on <a href=\"https://unsplash.com/\" target=\"_blank\">Unsplash</a></p>\n","prev":{"title":"A Step by Step How to Start Docker-compose Container at Boot","link":"2022/05/13/step-by-step-start-docker-compose-container-at-boot"},"plink":"https://jason19970210.github.io/2021/12/17/raspberry-pi -4-with-multiple-uart-interface/","toc":[{"id":"environment","title":"Environment","index":"1"},{"id":"software-setup","title":"Software Setup","index":"2"},{"id":"hardware-setup","title":"Hardware Setup","index":"3"},{"id":"implementation","title":"Implementation","index":"4"}],"reading_time":"485 words in 3 min"}
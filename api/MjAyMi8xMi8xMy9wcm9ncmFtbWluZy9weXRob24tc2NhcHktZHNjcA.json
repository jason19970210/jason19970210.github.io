{"title":"Sending TCP Packets with DSCP in Scapy","date":"2022-12-12T16:00:00.000Z","date_formatted":{"ll":"Dec 13, 2022","L":"12/13/2022","MM-DD":"12-13"},"link":"2022/12/13/programming/python-scapy-dscp","tags":["dscp","python","scapy","snippet"],"categories":["networking"],"updated":"2022-12-12T16:00:00.000Z","content":"<p>Type of Service (ToS) &amp; Differentiated Services <span style=\"font-size: 10px\">(Diffserv)</span> Codepoint (DSCP)<br>\nCheck the table: <a href=\"https://www.bytesolutions.com/dscp-tos-cos-presidence-conversion-chart/\" target=\"_blank\">https://www.bytesolutions.com/dscp-tos-cos-presidence-conversion-chart/</a></p>\n<span id=\"more\"></span>\n<figure class=\"highlight python\"><figcaption><span>scapy-tcp-dscp.py</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> scapy.sendrecv <span class=\"keyword\">import</span> sendp</span><br><span class=\"line\"><span class=\"keyword\">from</span> scapy.layers.l2 <span class=\"keyword\">import</span> Ether</span><br><span class=\"line\"><span class=\"keyword\">from</span> scapy.layers.inet <span class=\"keyword\">import</span> IP, TCP</span><br><span class=\"line\"></span><br><span class=\"line\">SRC_IP = <span class=\"string\">&quot;192.168.0.1&quot;</span></span><br><span class=\"line\">DST_IP = <span class=\"string\">&quot;192.168.0.2&quot;</span></span><br><span class=\"line\">SRC_IFACE = <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">DST_IFACE = <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">    sendp(Ether() / IP(src = SRC_IP, dst = DST_IP, tos = TOS_VALUE) / TCP(), iface = SRC_IFACE)</span><br></pre></td></tr></table></figure>","prev":{"title":"Lua Hello World & Package Management","link":"2022/12/20/programming/lua-hello-world-and-package-management"},"next":{"title":"Thread with Serial & Restful in Python","link":"2022/12/13/programming/python-thread-serial-restful"},"plink":"https://jason19970210.github.io/2022/12/13/programming/python-scapy-dscp/","reading_time":"81 words in 1 min"}